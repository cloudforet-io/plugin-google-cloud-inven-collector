# AI-인간 협업 프로토콜 1페이지 요약

1. **명세 작성**: docs/에 요구사항, API, 스키마, 데이터모델, 테스트케이스 등 파일 작성
2. **테스트케이스 작성**: 정상/예외/경계 포함, 별도 파일로 관리
3. **AI 코드/테스트/문서 제안**: 명세+테스트 기반, ruleset(.cursor/rules/) 준수
4. **리뷰/수정/승인**: 인간이 최종 검토, 피드백 기록
5. **배포/회고**: 변경이력(changelog) 기록, 회고/피드백 반영

- 모든 단계는 아래 체크리스트로 검증
- 상세 규칙/예시는 본문 및 docs/의 템플릿 참고

### 체크리스트
- [ ] docs/에 명세 파일(요구사항, API, 스키마, 데이터모델, 테스트케이스 등)이 모두 작성되었는가?
- [ ] 테스트케이스가 정상/예외/경계 상황을 모두 커버하는가?
- [ ] AI 산출물(코드/문서/테스트)이 ruleset과 명세를 모두 반영하는가?
- [ ] 리뷰/수정/승인 이력이 명확히 기록되었는가?
- [ ] 변경이력(changelog) 및 회고가 남아 있는가?

---

# Context Engineering 기반 AI-인간 협업 소프트웨어 개발 프레임워크

_– 목적, 철학, 실전 구조, 협업 프로토콜, 그리고 실행 수칙 –_

---

## 1. 프레임워크 개요

본 프레임워크는 **AI와 인간이 실질적으로 협업**하며, 소프트웨어 개발의 전 과정을 **맥락(Context) 중심**으로 지원·자동화하는 것을 목표로 합니다. 

> **AI의 완전 자동화가 아니라, 인간 주도의 의사결정과 AI의 맥락 기반 지원이 결합된 구조**

- **적용 범위:**
    - 요구사항 분석, 설계, 코드 생성, 테스트, 배포, 운영, 문서화 등 SDLC 전반
    - 각 단계에서 인간의 검토·의사결정·피드백이 필수적으로 개입

---

## 2. 프레임워크의 목적과 철학

- **AI는 “보조자/확장자”**
    - AI는 반복적/표준화된 작업, 맥락 기반 제안, 자동화된 품질 검증 등에서 인간 개발자를 지원합니다.
- **Context Engineering 실전 적용**
    - 프로젝트의 구조, 규칙, 명세, 코드, 테스트, 문서 등 모든 맥락 정보를 AI가 이해·활용할 수 있도록 구조화합니다.
- **Human-in-the-Loop, Protocol-Driven Collaboration**
    - 인간과 AI가 “정해진 프로토콜/수칙”에 따라 각 단계별로 명확히 협업합니다.
- **지속적 개선과 투명성**
    - 모든 의사결정, 변경, 피드백, 품질 검증이 기록·공유되고 프레임워크와 AI는 이를 바탕으로 지속적으로 진화합니다.

---

## 3. 실제 구현 구조 및 Context Engineering 적용 사례

### 3.1. 프로젝트 구조 (웹 애플리케이션 예시)

- **계층형 구조**: `src/` 하위에 `api/`(라우팅), `services/`(비즈니스 로직), `models/`(데이터 모델), `core/`(공통 모듈) 등으로 역할을 분리합니다.
- **관심사 분리**: `test/`, `docs/`, `scripts/` 등 개발, 문서, 운영에 필요한 요소를 명확히 분리합니다.
- **모듈화**: 각 기능 또는 도메인별로 디렉토리를 분리하여 관리합니다. (예: `users/`, `products/`)

```
src/
├── api/
│   └── v1/
│       ├── users_router.py      # API 엔드포인트 정의
│       └── products_router.py
├── services/
│   ├── users_service.py         # 비즈니스 로직
│   └── products_service.py
├── models/
│   ├── user.py                  # 데이터베이스 모델
│   └── product.py
└── core/
    └── db.py                    # DB 연결 및 공통 설정
```

### 3.2. Ruleset (프로젝트 맞춤형 규칙)

- `.cursor/rules/project-rules.mdc` 등에 프로젝트의 코딩 표준, 아키텍처, 보안 규칙 등을 명문화합니다.
- API 설계 원칙, 에러 처리 방식, 로깅 규칙, 테스트 작성 가이드 등을 포함합니다.
- **AI와 인간이 프로젝트의 일관된 규칙을 준수하는 "행동 지침서" 역할을 합니다.**

### 3.3. Documentation (체계적인 문서화)

- `docs/` 디렉토리 내에 기능별 제품 요구사항 정의서(PRD)를 관리합니다. (예: `docs/users/api.md`)
- 전사/팀 레벨의 개발 가이드, 아키텍처 문서, 로깅 표준 등을 함께 관리합니다.
- **AI가 새로운 기능 개발 시 참조할 수 있도록 요구사항과 구현 명세를 구조화합니다.**

### 3.4. 기능 명세 (요구사항 기반)

- 각 기능별 PRD는 `docs/{feature}/` 디렉토리에 관리합니다.
- 비즈니스 요구사항, API 인터페이스, 데이터 모델, 로직 플로우, 보안 및 성능 요구사항 등을 포함합니다.
- 프로젝트의 표준 구조에 맞춘 개발 지시사항을 명시합니다.
- **AI가 외부 API 문서와 내부 규칙을 결합하여 코드를 생성할 수 있도록 상세한 맥락을 제공합니다.**

### 3.5. Context Engineering 실전

- 위 구조/문서/규칙이 모두 AI가 이해할 수 있는 형태로 구조화되어
- **“맥락 기반” 코드 생성, 테스트, 문서화, 품질 검증이 가능**

---

## 4. AI-인간 협업 프로토콜 및 실행 수칙

### 4.1. 단계별 협업 구조와 역할

각 단계는 인간과 AI가 동시에 또는 교차적으로 다양한 역할을 수행하는 협업 루프입니다. 한 단계가 한 주체의 몫이 아니며, 각 단계 내에서 상호 피드백과 반복이 필수적입니다.

---

#### 1단계: 업무 명세서 작성 및 고도화

- **참여자/역할**
    - 인간(기획자/개발자): 요구/기능 초안 작성, 도메인 지식/비즈니스 목표 명시
    - AI(명세 구조화/질문/보완자): 초안 명세 구조화, 누락/모호함/불일치 탐지 및 질문, 예시/테스트케이스/예외/제약조건 자동 보완 제안
    - **AI(입력/출력 데이터 초안 제안자):** 명세/요구/테스트케이스/유사 기능을 참고해 입력/출력 데이터 구조/예시(JSON, 표 등)를 자동 제안하고, 필요한 경우 질문도 함께 제시

**🎯 인간 초안 작성 가이드**

인간이 작성해야 할 **최소 필수 초안** (5-10분 내 작성 가능):

```markdown
## 기능: [기능명]
**목적:** [1-2문장으로 왜 이 기능이 필요한지]

**핵심 요구사항 (3-5개):**
1. [주요 기능 1]
2. [주요 기능 2] 
3. [예외/제약사항 1]

**대략적 흐름:**
- 입력: [대략적 입력 설명]
- 처리: [핵심 비즈니스 로직 1-2줄]
- 출력: [대략적 출력 설명]

**특별 고려사항:**
- [성능/보안/권한 등 특이사항이 있다면]
```

**🤖 AI 명령 프롬프트 템플릿 (예시)**

```text
아래 기능 초안을 우리 팀의 표준 PRD 형식으로 발전시켜줘.

[인간이 작성한 초안 붙여넣기]

**요청사항:**
1. 사용자 관리 기능의 요구사항 명시
2. RESTful API 데이터 모델 설계 (Request/Response)
3. 데이터베이스 스키마 및 관계 정의
4. 에러 처리 및 인증/인가 로직 정의
5. 성능 및 보안 고려사항 포함
6. .cursor/rules/project-rules.mdc의 프로젝트 규칙 준수

**프로젝트 컨텍스트:**
- Python FastAPI + SQLAlchemy
- 아키텍처: Controller-Service-Repository 패턴
- 인증: JWT 기반
- 테스트: pytest + factory-boy
- 데이터 모델: Pydantic 기반 모델

**출력 형식:**
- docs/users/ 디렉토리의 PRD 문서 형태
- 관련 표준/가이드 문서 링크 포함
- 개발 지시사항 명시
- 불확실한 부분은 [질문: ...] 형태로 명시
- 가정한 부분은 [가정: ...] 형태로 명시
```

- **협업 루프**
    1. **인간이 5-10분 초안 작성** (위 가이드 참고)
    2. **AI에게 상세화 명령** (위 프롬프트 템플릿 사용)
    3. **AI가 분리된 명세 파일(요구사항, API, 스키마, 데이터모델, 테스트, 프롬프트, changelog 등) + 질문/가정 리스트 제공**
    4. **인간이 질문 답변 + 가정 검토/수정**
    5. **AI가 최종 명세 파일 집합 생성**
    6. **체크리스트 기반 검증 (인간 주도)**
    7. **"명세서 승인" 후 다음 단계로**

---

#### 2단계: 테스트케이스 작성 및 승인 (테스트 우선)

- **참여자/역할**
    - AI(테스트케이스 제안자, 커버리지 점검자)
    - 인간(테스트케이스 리뷰어, 보완자, 승인자)
- **협업 루프**
    1. AI/인간이 명세 기반으로 테스트케이스(코드/문서) 초안 작성 (예: pytest, BDD, markdown 등)
    2. AI가 누락/모호함/경계/예외 조건을 질문/보완 제안
    3. 인간이 답변/수정/추가
    4. AI가 재구조화/최종 테스트케이스 생성
    5. 인간/AI가 체크리스트(명세 커버리지, 예외/경계 포함 등)로 검증
    6. "테스트케이스 승인" 후 다음 단계로
- **산출물/완료조건**
    <!-- - docs/5.test-cases.yaml 등 분리된 테스트케이스 파일에 포함 -->
    - 명세서의 모든 요구/예외/경계조건 커버
    - 리뷰/피드백/수정 이력 기록
    - 승인 체크리스트 통과
- **비고**
    - 테스트케이스는 반드시 docs/test-cases.yaml 등 별도 파일로 분리 관리
    - 테스트케이스가 승인된 후에만 실제 비즈니스 코드/구현 단계로 진행할 수 있음

---

#### 3단계: 설계/코드/테스트/문서화 제안

- **참여자/역할**
    - AI(코드/테스트/문서 제안자, 규칙 적용자, 품질 점검자)
    - 인간(설계/코드/테스트/문서 리뷰어, 보완자, 승인자)
- **협업 루프**
    1. AI가 명세/테스트케이스/규칙 기반 산출물(코드/문서) 제안
    2. 인간이 리뷰/수정/질문/보완
    3. AI가 피드백 반영/재생성/추가 설명
    4. 반복
    5. 체크리스트 기반 검증 후 승인
- **산출물/완료조건**
    - 코드/문서/설계 산출물
    - 근거/한계/불확실성 명시
    - 리뷰/피드백/수정 이력 기록
    - 승인 체크리스트 통과

---

#### 4단계: 리뷰/품질 검증/최종 승인

- **참여자/역할**
    - AI(자동 리뷰어, 테스트 자동화, 품질 점검자)
    - 인간(최종 리뷰어, QA, PM, 승인자)
- **협업 루프**
    1. AI가 자동 리뷰/테스트/품질 점검
    2. 인간이 수동 리뷰/보완/최종 승인
    3. 피드백/수정 반복
    4. 승인/반려 명확히 기록
- **산출물/완료조건**
    - 리뷰/테스트/품질 점검 결과
    - 승인/반려/수정 이력
    - 모든 검증 항목 충족

---

### 4.2. 역할 정의 표

| 역할명           | 주체   | 책임/행위                                 |
|------------------|--------|-------------------------------------------|
| 명세 초안 작성자   | 인간   | 요구/기능 초안 작성, 도메인 지식 제공     |
| 명세 구조화/질문자 | AI     | 명세 구조화, 누락/모호함 탐지, 질문 제안  |
| 명세 보완자       | 인간/AI | 질문 답변, 추가/수정, 예시/테스트 보완    |
| 코드/테스트 제안자 | AI     | 명세/규칙 기반 코드/테스트/문서 제안      |
| 리뷰어           | 인간/AI | 코드/테스트/문서/명세 리뷰, 피드백 제공   |
| 품질 점검자       | AI     | 자동 테스트/품질 점검, 커버리지 분석      |
| 최종 승인자       | 인간   | 최종 승인/반려, 배포 결정                |

---

### 4.3. 프롬프트/AI응답/리뷰 예시

```text
아래 docs/users/의 PRD와 .cursor/rules/project-rules.mdc의 네이밍 규칙을 참고해서,
신규 사용자 목록 조회 API 코드를 작성해줘.
- users_router.py에 GET /users 엔드포인트 구현
- 페이지네이션(pagination) 및 에러 처리 포함
- users_service.py의 비즈니스 로직과 연동
- 테스트 코드도 함께 작성해줘.
```

```text
아래 코드는 docs/users/api.md PRD와 ruleset을 반영했습니다.
- users_router.py: FastAPI 엔드포인트 및 DI(의존성 주입) 설정
- users_service.py: 페이지네이션 로직 구현
- 에러 처리: 존재하지 않는 페이지 요청 등 예외 처리 포함
- 테스트: pytest.fixture를 사용해 테스트 데이터 생성
**한계:** 대용량 데이터(100만 이상) 조회 시 성능 저하가 발생할 수 있어, DB 인덱싱 전략 추가 검토가 필요합니다.
```

```text
테스트 코드에서 정렬(sorting) 기능에 대한 테스트 케이스가 누락되었습니다.
또한, 프로젝트의 표준 에러 응답 모델을 사용하도록 수정해 주세요.
```

---

### 4.4. 단계별 체크리스트(예시)

- [ ] docs/의 명세 파일에 입력/출력/예외/테스트 조건이 모두 포함되어 있는가?
- [ ] 프롬프트에 명세/규칙/출력형식/제약조건이 모두 명시되어 있는가?
- [ ] AI 산출물에 근거/한계/불확실성이 명확히 기술되어 있는가?
- [ ] 리뷰 결과가 구체적으로 기록되어 있는가?
- [ ] 승인/반려/수정 요청이 명확히 구분되어 있는가?
- [ ] 모든 과정이 기록/공유되고 있는가?
- 참고: 효율성/품질 지표(Cycle Time, Coverage %, Error Rate 등)도 함께 측정/관리한다

---

## 5. 실전 적용 예시

### 5.1. 기능 개발 플로우

1. Feature 명세 작성/수정 (docs/ 내 요구사항, API, 스키마, 데이터모델, 테스트케이스 등 파일)
2. AI가 명세 기반 코드/테스트/문서/자동화 제안
3. 인간 검토/수정/승인
4. AI가 반영 및 자동화
5. 테스트/리뷰/문서화/배포
6. 회고/피드백/규칙 업데이트
- 참고: Git 브랜치 전략(main, develop, feature/xxx 등), CI/CD 파이프라인 스크립트(예: pytest, flake8 등)도 실전 적용에 포함한다

### 5.2. Context Engineering 적용

- ruleset(.cursor/rules/), 분리된 명세 파일(docs/), 코드, 테스트, 문서가 모두 “AI가 이해할 수 있는 구조”로 관리
- 예: docs/의 각 파일이 코드/테스트/문서/자동화에 실시간 context로 반영

---

## 6. 향후 발전 방향

- 멀티에이전트 협업, 자연어 기반 요구사항 처리, 실시간 품질/보안/컴플라이언스 자동화, 다양한 도메인/플랫폼 확장 등
- 참고: 단기(3개월)/중기(6개월)/장기(1년) 로드맵(예: 템플릿 자동화, context manifest 기반 협업, 도구 연동/보안 자동화 등)도 명확히 한다